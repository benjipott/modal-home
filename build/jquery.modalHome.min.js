/*! jQuery ModalHome - version:0.2 - Dan Miller https://github.com/dmill109/modal-home - 21-05-2013 */
(function(o){var e={},n=function(){return e},m=function(n){return e=o.extend({content:"",immediateDisplay:!1,modalHomeBg:"jhm-modal-bg",modalHomeDiv:"jhm-modal",modalHomeClose:"jhm-modal-close",modalHomeLoader:"jhm-modal-loading",modalHomeContent:"jhm-modal-content",modalHomeOpenEvent:"jhm.modal.open",modalHomeCloseEvent:"jhm.modal.close"},n)},t={init:function(e){var n=m(e);this.length>0&&""!==this.html()&&(n.content=this.html(),m(n));var t=o("."+n.modalHomeBg),s=o("."+n.modalHomeDiv);return 0===t.length&&(t=a()),0===s.length&&(s=l()),n.content.length>0&&(n.immediateDisplay=!0,r(n.content)),o("."+n.modalHomeClose).on("click",function(){s.trigger(n.modalHomeCloseEvent)}),s.on(n.modalHomeCloseEvent,function(){i(s),s.off(n.modalHomeCloseEvent)}),s.on(n.modalHomeOpenEvent,function(){d(s),s.off(n.modalHomeOpenEvent)}),o("body").on("keyup",function(o){27===o.which&&s.trigger(n.modalHomeCloseEvent)}),o("."+n.modalHomeBg).on("click",function(){s.trigger(n.modalHomeCloseEvent)}),n.immediateDisplay===!0&&s.trigger(n.modalHomeOpenEvent),{modal:s,modalBg:t}},ajax:function(e){var m=o.fn.modalHome(e),t=n();s(),m.modal.trigger(t.modalHomeOpenEvent),o.ajax({url:e.url}).done(function(n){r(n),o.isFunction(e.success)&&e.success(n),c()}).error(function(n){r("Failed to load resource"),o.isFunction(e.failure)&&e.failure(n),c()})},hide:function(){var e=n();o("."+e.modalHomeDiv).trigger(e.modalHomeCloseEvent)}},a=function(){var e=n();return o("body").append('<div class="'+e.modalHomeBg+'" />')},l=function(){var e=n();return o("."+e.modalHomeBg).before('<div class="'+e.modalHomeDiv+'"><div class="'+e.modalHomeClose+'">x</div><div class="'+e.modalHomeLoader+'"></div><div class="'+e.modalHomeContent+'"></div></div>')},d=function(){var e=n(),m=parseInt(o("."+e.modalHomeDiv).css("top").replace("px",""),10),t=parseInt(o(document).scrollTop(),10);o("."+e.modalHomeBg).show(),o("."+e.modalHomeDiv).css({top:t+m}),o("."+e.modalHomeDiv).fadeIn(500)},i=function(){var e=n();o("."+e.modalHomeDiv).fadeOut(500),o("."+e.modalHomeBg).delay(500).hide()},r=function(e){var m=n();o("."+m.modalHomeContent).html(e)},s=function(){var e=n();o("."+e.modalHomeContent).hide(),o("."+e.modalHomeLoader).show()},c=function(){var e=n();o("."+e.modalHomeContent).show(),o("."+e.modalHomeLoader).hide()};o.fn.modalHome=function(e){return o(this),t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(o.error("Method "+e+" does not exist on jQuery.modalHome"),this):t.init.apply(this,arguments)}})(jQuery);