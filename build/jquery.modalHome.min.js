/*! jQuery ModalHome - 0.1 - 10-05-2013 */
(function(o){var e={},n=function(){return e},l=function(n){return e=o.extend({content:"",immediateDisplay:!1,modalHomeBg:"jhm-modal-bg",modalHomeDiv:"jhm-modal",modalHomeClose:"jhm-modal-close",modalHomeLoader:"jhm-modal-loading",modalHomeContent:"jhm-modal-content",modalHomeOpenEvent:"jhm.modal.open",modalHomeCloseEvent:"jhm.modal.close"},n)},m={init:function(e){var n=l(e);this.length>0&&""!==this.html()&&(n.content=this.html(),l(n));var m=o("."+n.modalHomeBg),c=o("."+n.modalHomeDiv);return 0===m.length&&(m=t()),0===c.length&&(c=a()),n.content.length>0&&(n.immediateDisplay=!0,s(n.content)),o("."+n.modalHomeClose).on("click",function(){console.log("close click"),c.trigger(n.modalHomeCloseEvent)}),console.log("setup events"),c.on(n.modalHomeCloseEvent,function(){console.log(n.modalHomeCloseEvent+" event"),i(c),c.off(n.modalHomeCloseEvent)}),c.on(n.modalHomeOpenEvent,function(){console.log(n.modalHomeOpenEvent+" event"),d(c),c.off(n.modalHomeOpenEvent)}),o("body").on("keyup",function(o){27===o.which&&c.trigger(n.modalHomeCloseEvent)}),o("."+n.modalHomeBg).on("click",function(){c.trigger(n.modalHomeCloseEvent)}),n.immediateDisplay===!0&&c.trigger(n.modalHomeOpenEvent),{modal:c,modalBg:m}},ajax:function(e){console.log("ajax init");var l=o.fn.modalHome(e),m=n();c(),l.modal.trigger(m.modalHomeOpenEvent),o.ajax({url:e.url}).done(function(n){console.log("ajax success"),s(n),o.isFunction(e.success)&&e.success(n),r()}).error(function(n){console.log("ajax failure",n,n.statusCode()),s("Failed to load resource"),o.isFunction(e.failure)&&e.failure(n),r()})},hide:function(){var e=n();o("."+e.modalHomeDiv).trigger(e.modalHomeCloseEvent)}},t=function(){var e=n();return o("body").append('<div class="'+e.modalHomeBg+'" />')},a=function(){var e=n();return o("."+e.modalHomeBg).before('<div class="'+e.modalHomeDiv+'"><div class="'+e.modalHomeClose+'">x</div><div class="'+e.modalHomeLoader+'"></div><div class="'+e.modalHomeContent+'"></div></div>')},d=function(){var e=n();console.log("reveal"),o("."+e.modalHomeBg).show(),o("."+e.modalHomeDiv).fadeIn(500)},i=function(){var e=n();console.log("hide"),o("."+e.modalHomeDiv).fadeOut(500),o("."+e.modalHomeBg).delay(500).hide()},s=function(e){var l=n();console.log("populate content",e),o("."+l.modalHomeContent).html(e)},c=function(){var e=n();o("."+e.modalHomeContent).hide(),o("."+e.modalHomeLoader).show()},r=function(){var e=n();o("."+e.modalHomeContent).show(),o("."+e.modalHomeLoader).hide()};o.fn.modalHome=function(e){return o(this),m[e]?m[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(o.error("Method "+e+" does not exist on jQuery.modalHome"),this):m.init.apply(this,arguments)}})(jQuery);